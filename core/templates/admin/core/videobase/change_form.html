{% extends "admin/change_form.html" %}
{% load i18n %}

{% block after_field_sets %}
    {{ block.super }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.querySelector('input[name="arquivo_video"]');
            if (fileInput) {
                fileInput.setAttribute('multiple', 'true');
                fileInput.setAttribute('name', 'arquivo_video_multiple');

                const titlesContainer = document.createElement('div');
                titlesContainer.id = 'custom-titles-container';
                
                const helpText = document.createElement('div');
                helpText.className = 'help';
                helpText.innerHTML = 'Você pode selecionar múltiplos arquivos de vídeo para upload. <br> Você pode deixar os títulos em branco para usar os nomes dos arquivos como títulos.';

                const customTitleHeader = document.createElement('h4');
                customTitleHeader.textContent = 'Títulos Customizados (Opcional)';

                fileInput.parentNode.appendChild(helpText);
                fileInput.parentNode.appendChild(customTitleHeader);
                fileInput.parentNode.appendChild(titlesContainer);

                fileInput.addEventListener('change', function() {
                    titlesContainer.innerHTML = '';
                    for (let i = 0; i < this.files.length; i++) {
                        const file = this.files[i];
                        const titleInputDiv = document.createElement('div');
                        titleInputDiv.classList.add('form-row');
                        
                        const label = document.createElement('label');
                        label.textContent = `Título para "${file.name}":`;
                        label.style.fontWeight = 'normal';
                        label.style.marginBottom = '5px';

                        const input = document.createElement('input');
                        input.type = 'text';
                        input.name = 'titulos_customizados';
                        input.placeholder = 'Opcional - Padrão: nome do arquivo';
                        input.style.width = '100%';
                        
                        titleInputDiv.appendChild(label);
                        titleInputDiv.appendChild(input);
                        titlesContainer.appendChild(titleInputDiv);
                    }
                });
            }
        });
    </script>
{% endblock %}